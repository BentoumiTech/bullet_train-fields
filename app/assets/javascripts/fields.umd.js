!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("stimulus"),require("@simonwep/pickr/dist/themes/monolith.min.css"),require("@simonwep/pickr")):"function"==typeof define&&define.amd?define(["exports","stimulus","@simonwep/pickr/dist/themes/monolith.min.css","@simonwep/pickr"],e):e((t||self).fields={},t.stimulus,0,t.Pickr)}(this,function(t,e,o,i){function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=r(i);function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,l(t,e)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}var s=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.clickShadowField=function(t){t.preventDefault(),this.shadowFieldTarget.click()},e}(e.Controller);s.targets=["shadowField"];var u=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var o=e.prototype;return o.pickImageAndUpload=function(t){t.preventDefault();var e=["local","url","camera"];this.hasGoogleApiKeyValue&&e.push("image_search");var o={cloud_name:this.cloudNameValue,apiKey:this.apiKeyValue,upload_preset:this.uploadPresetValue,upload_signature:this.getCloudinarySignature.bind(this),multiple:!1,sources:this.hasSourcesValue?this.sourcesValue.split(","):e,search_by_rights:!this.hasSearchByRightsValue||!1!==this.searchByRightsValue};this.hasGoogleApiKeyValue&&(o.google_api_key=this.googleApiKeyValue),cloudinary.openUploadWidget(o,this.handleWidgetResponse.bind(this))},o.clearImage=function(t){t.preventDefault(),this.hiddenFieldTarget.value=null,this.removeThumbnail()},o.getCloudinarySignature=function(t,e){$.ajax({url:this.signaturesUrlValue,type:"GET",dataType:"text",data:{data:e},complete:function(){console.log("complete")},success:function(e,o,i){t(e)},error:function(t,e,o){console.log(t,e,o)}})},o.handleWidgetResponse=function(t,e){if(!t&&e&&"success"===e.event){var o=e.info;this.hiddenFieldTarget.value=o.public_id,this.removeThumbnail(),this.addThumbnail(this.urlFormatValue.replace("CLOUDINARY_ID",o.public_id))}},o.addThumbnail=function(t){var e=$('<img src="'+t+'" width="'+this.widthValue+'" height="'+this.heightValue+'" data-'+this.identifier+'-target="thumbnail" />');$(this.uploadButtonTarget).prepend(e),this.uploadButtonTarget.classList.add(this.thumbnailShownClass)},o.removeThumbnail=function(){this.hasThumbnailTarget&&(this.uploadButtonTarget.removeChild(this.thumbnailTarget),this.uploadButtonTarget.classList.remove(this.thumbnailShownClass))},e}(e.Controller);u.targets=["uploadButton","hiddenField","thumbnail"],u.values={signaturesUrl:String,height:Number,width:Number,cloudName:String,apiKey:String,googleApiKey:String,urlFormat:String,sources:String,searchByRights:Boolean},u.classes=["thumbnailShown"];var c=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var o=e.prototype;return o.connect=function(){this.initPluginInstance(),this.colorOptions=$(this.colorOptionsTarget).find("button").map(function(t,e){return $(e).attr("data-color")}).get()},o.disconnect=function(){this.teardownPluginInstance()},o.pickColor=function(t){t.preventDefault();var e=t.target,o=e.dataset.color;$(this.colorInputTarget).val(o),$(this.colorPickerValueTarget).val(o),$(this.userSelectedColorTarget).data("color",o),$(".button-color").removeClass("ring-2 ring-offset-2"),this.pickr.setColor(o),e.classList.add("ring-2","ring-offset-2")},o.pickRandomColor=function(t){t.preventDefault();var e=Math.floor(256*Math.random()),o=Math.floor(256*Math.random()),i=Math.floor(256*Math.random());this.pickr.setColor("rgb "+e+" "+o+" "+i);var r=this.pickr.getColor().toHEXA().toString();this.pickr.setColor(r),this.showUserSelectedColor(r)},o.showUserSelectedColor=function(t){$(this.colorInputTarget).val(t),$(this.colorPickerValueTarget).val(t),$(".button-color").removeClass("ring-2 ring-offset-2"),$(this.userSelectedColorTarget).addClass("ring-2").addClass("ring-offset-2").css("background-color",t).css("--tw-ring-color",t).attr("data-color",t).show()},o.unpickColor=function(t){t.preventDefault(),$(this.colorPickerValueTarget).val(""),$(this.colorInputTarget).val(""),$(this.userSelectedColorTarget).hide(),$(".button-color").removeClass("ring-2 ring-offset-2")},o.togglePickr=function(t){t.preventDefault()},o.initPluginInstance=function(){var t=this;this.pickr=n.default.create({el:".btn-pickr",theme:"monolith",useAsButton:!0,default:this.initialColorValue||"#1E90FF",components:{preview:!0,hue:!0,interaction:{input:!0,save:!0}}}),this.pickr.on("save",function(e,o){var i=e.toHEXA().toString();t.colorOptions.includes(i)||t.showUserSelectedColor(i),t.pickr.hide()});var e=this;$('input[type="text"].pcr-result').on("keydown",function(t){"Enter"===t.key&&e.pickr.applyColor(!1)})},o.teardownPluginInstance=function(){this.pickr.destroy()},e}(e.Controller);c.targets=["colorPickerValue","colorField","colorInput","userSelectedColor","colorOptions"],c.values={initialColor:String},t.ButtonToggleController=s,t.CloudinaryImageController=u,t.ColorPickerController=c});
//# sourceMappingURL=fields.umd.js.map
