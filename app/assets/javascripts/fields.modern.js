import{Controller as t}from"stimulus";import"@simonwep/pickr/dist/themes/monolith.min.css";import e from"@simonwep/pickr";class o extends t{clickShadowField(t){t.preventDefault(),this.shadowFieldTarget.click()}}o.targets=["shadowField"];class i extends t{pickImageAndUpload(t){t.preventDefault();var e=["local","url","camera"];this.hasGoogleApiKeyValue&&e.push("image_search");var o={cloud_name:this.cloudNameValue,apiKey:this.apiKeyValue,upload_preset:this.uploadPresetValue,upload_signature:this.getCloudinarySignature.bind(this),multiple:!1,sources:this.hasSourcesValue?this.sourcesValue.split(","):e,search_by_rights:!this.hasSearchByRightsValue||!1!==this.searchByRightsValue};this.hasGoogleApiKeyValue&&(o.google_api_key=this.googleApiKeyValue),cloudinary.openUploadWidget(o,this.handleWidgetResponse.bind(this))}clearImage(t){t.preventDefault(),this.hiddenFieldTarget.value=null,this.removeThumbnail()}getCloudinarySignature(t,e){$.ajax({url:this.signaturesUrlValue,type:"GET",dataType:"text",data:{data:e},complete:function(){console.log("complete")},success:function(e,o,i){t(e)},error:function(t,e,o){console.log(t,e,o)}})}handleWidgetResponse(t,e){if(!t&&e&&"success"===e.event){const t=e.info;this.hiddenFieldTarget.value=t.public_id,this.removeThumbnail(),this.addThumbnail(this.urlFormatValue.replace("CLOUDINARY_ID",t.public_id))}}addThumbnail(t){var e=$(`<img src="${t}" width="${this.widthValue}" height="${this.heightValue}" data-${this.identifier}-target="thumbnail" />`);$(this.uploadButtonTarget).prepend(e),this.uploadButtonTarget.classList.add(this.thumbnailShownClass)}removeThumbnail(){this.hasThumbnailTarget&&(this.uploadButtonTarget.removeChild(this.thumbnailTarget),this.uploadButtonTarget.classList.remove(this.thumbnailShownClass))}}i.targets=["uploadButton","hiddenField","thumbnail"],i.values={signaturesUrl:String,height:Number,width:Number,cloudName:String,apiKey:String,googleApiKey:String,urlFormat:String,sources:String,searchByRights:Boolean},i.classes=["thumbnailShown"];class s extends t{connect(){this.initPluginInstance(),this.colorOptions=$(this.colorOptionsTarget).find("button").map(function(t,e){return $(e).attr("data-color")}).get()}disconnect(){this.teardownPluginInstance()}pickColor(t){t.preventDefault();const e=t.target,o=e.dataset.color;$(this.colorInputTarget).val(o),$(this.colorPickerValueTarget).val(o),$(this.userSelectedColorTarget).data("color",o),$(".button-color").removeClass("ring-2 ring-offset-2"),this.pickr.setColor(o),e.classList.add("ring-2","ring-offset-2")}pickRandomColor(t){t.preventDefault();const e=Math.floor(256*Math.random()),o=Math.floor(256*Math.random()),i=Math.floor(256*Math.random());this.pickr.setColor(`rgb ${e} ${o} ${i}`);const s=this.pickr.getColor().toHEXA().toString();this.pickr.setColor(s),this.showUserSelectedColor(s)}showUserSelectedColor(t){$(this.colorInputTarget).val(t),$(this.colorPickerValueTarget).val(t),$(".button-color").removeClass("ring-2 ring-offset-2"),$(this.userSelectedColorTarget).addClass("ring-2").addClass("ring-offset-2").css("background-color",t).css("--tw-ring-color",t).attr("data-color",t).show()}unpickColor(t){t.preventDefault(),$(this.colorPickerValueTarget).val(""),$(this.colorInputTarget).val(""),$(this.userSelectedColorTarget).hide(),$(".button-color").removeClass("ring-2 ring-offset-2")}togglePickr(t){t.preventDefault()}initPluginInstance(){this.pickr=e.create({el:".btn-pickr",theme:"monolith",useAsButton:!0,default:this.initialColorValue||"#1E90FF",components:{preview:!0,hue:!0,interaction:{input:!0,save:!0}}}),this.pickr.on("save",(t,e)=>{const o=t.toHEXA().toString();this.colorOptions.includes(o)||this.showUserSelectedColor(o),this.pickr.hide()});const t=this;$('input[type="text"].pcr-result').on("keydown",function(e){"Enter"===e.key&&t.pickr.applyColor(!1)})}teardownPluginInstance(){this.pickr.destroy()}}s.targets=["colorPickerValue","colorField","colorInput","userSelectedColor","colorOptions"],s.values={initialColor:String};export{o as ButtonToggleController,i as CloudinaryImageController,s as ColorPickerController};
//# sourceMappingURL=fields.modern.js.map
