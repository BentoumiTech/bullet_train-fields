import{Controller as t}from"stimulus";import"@simonwep/pickr/dist/themes/monolith.min.css";import e from"@simonwep/pickr";function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,i(t,e)}function i(t,e){return i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}var r=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e.prototype.clickShadowField=function(t){t.preventDefault(),this.shadowFieldTarget.click()},e}(t);r.targets=["shadowField"];var n=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var i=e.prototype;return i.pickImageAndUpload=function(t){t.preventDefault();var e=["local","url","camera"];this.hasGoogleApiKeyValue&&e.push("image_search");var o={cloud_name:this.cloudNameValue,apiKey:this.apiKeyValue,upload_preset:this.uploadPresetValue,upload_signature:this.getCloudinarySignature.bind(this),multiple:!1,sources:this.hasSourcesValue?this.sourcesValue.split(","):e,search_by_rights:!this.hasSearchByRightsValue||!1!==this.searchByRightsValue};this.hasGoogleApiKeyValue&&(o.google_api_key=this.googleApiKeyValue),cloudinary.openUploadWidget(o,this.handleWidgetResponse.bind(this))},i.clearImage=function(t){t.preventDefault(),this.hiddenFieldTarget.value=null,this.removeThumbnail()},i.getCloudinarySignature=function(t,e){$.ajax({url:this.signaturesUrlValue,type:"GET",dataType:"text",data:{data:e},complete:function(){console.log("complete")},success:function(e,o,i){t(e)},error:function(t,e,o){console.log(t,e,o)}})},i.handleWidgetResponse=function(t,e){if(!t&&e&&"success"===e.event){var o=e.info;this.hiddenFieldTarget.value=o.public_id,this.removeThumbnail(),this.addThumbnail(this.urlFormatValue.replace("CLOUDINARY_ID",o.public_id))}},i.addThumbnail=function(t){var e=$('<img src="'+t+'" width="'+this.widthValue+'" height="'+this.heightValue+'" data-'+this.identifier+'-target="thumbnail" />');$(this.uploadButtonTarget).prepend(e),this.uploadButtonTarget.classList.add(this.thumbnailShownClass)},i.removeThumbnail=function(){this.hasThumbnailTarget&&(this.uploadButtonTarget.removeChild(this.thumbnailTarget),this.uploadButtonTarget.classList.remove(this.thumbnailShownClass))},e}(t);n.targets=["uploadButton","hiddenField","thumbnail"],n.values={signaturesUrl:String,height:Number,width:Number,cloudName:String,apiKey:String,googleApiKey:String,urlFormat:String,sources:String,searchByRights:Boolean},n.classes=["thumbnailShown"];var a=function(t){function i(){return t.apply(this,arguments)||this}o(i,t);var r=i.prototype;return r.connect=function(){this.initPluginInstance(),this.colorOptions=$(this.colorOptionsTarget).find("button").map(function(t,e){return $(e).attr("data-color")}).get()},r.disconnect=function(){this.teardownPluginInstance()},r.pickColor=function(t){t.preventDefault();var e=t.target,o=e.dataset.color;$(this.colorInputTarget).val(o),$(this.colorPickerValueTarget).val(o),$(this.userSelectedColorTarget).data("color",o),$(".button-color").removeClass("ring-2 ring-offset-2"),this.pickr.setColor(o),e.classList.add("ring-2","ring-offset-2")},r.pickRandomColor=function(t){t.preventDefault();var e=Math.floor(256*Math.random()),o=Math.floor(256*Math.random()),i=Math.floor(256*Math.random());this.pickr.setColor("rgb "+e+" "+o+" "+i);var r=this.pickr.getColor().toHEXA().toString();this.pickr.setColor(r),this.showUserSelectedColor(r)},r.showUserSelectedColor=function(t){$(this.colorInputTarget).val(t),$(this.colorPickerValueTarget).val(t),$(".button-color").removeClass("ring-2 ring-offset-2"),$(this.userSelectedColorTarget).addClass("ring-2").addClass("ring-offset-2").css("background-color",t).css("--tw-ring-color",t).attr("data-color",t).show()},r.unpickColor=function(t){t.preventDefault(),$(this.colorPickerValueTarget).val(""),$(this.colorInputTarget).val(""),$(this.userSelectedColorTarget).hide(),$(".button-color").removeClass("ring-2 ring-offset-2")},r.togglePickr=function(t){t.preventDefault()},r.initPluginInstance=function(){var t=this;this.pickr=e.create({el:".btn-pickr",theme:"monolith",useAsButton:!0,default:this.initialColorValue||"#1E90FF",components:{preview:!0,hue:!0,interaction:{input:!0,save:!0}}}),this.pickr.on("save",function(e,o){var i=e.toHEXA().toString();t.colorOptions.includes(i)||t.showUserSelectedColor(i),t.pickr.hide()});var o=this;$('input[type="text"].pcr-result').on("keydown",function(t){"Enter"===t.key&&o.pickr.applyColor(!1)})},r.teardownPluginInstance=function(){this.pickr.destroy()},i}(t);a.targets=["colorPickerValue","colorField","colorInput","userSelectedColor","colorOptions"],a.values={initialColor:String};export{r as ButtonToggleController,n as CloudinaryImageController,a as ColorPickerController};
//# sourceMappingURL=fields.esm.js.map
